# CLAUDE.MD - The Orrery Project Guide

## âš ï¸ FOUNDATIONAL TRUTH â€” READ FIRST

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  LIFE IS THE GAME.                                                       â•‘
â•‘                                                                          â•‘
â•‘  Not: "Life with game mechanics added"                                   â•‘
â•‘  Not: "Productivity gamified"                                            â•‘
â•‘  But: Life IS the game. You ARE the player. WorldOE IS the interface.    â•‘
â•‘                                                                          â•‘
â•‘  The Orrery is Layer 1 of this game - the GAME WORLD you see and inhabit.â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**If you lose sight of this, you will build the wrong thing.**

---

## ğŸ® THE THREE LAYERS (Memorize This)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚  LAYER 1: GAME WORLD (Diegetic)                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                         â”‚
â”‚  What the player SEES and INHABITS                                      â”‚
â”‚                                                                         â”‚
â”‚  â€¢ The Orrery (quest constellation, task DAG, GPS)                      â”‚
â”‚  â€¢ Creative artifacts (documents, projects, worlds)                     â”‚
â”‚  â€¢ The Vault (explorable lore, accumulated canon)                       â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  LAYER 2: THE PARTY (Diegetic)                                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                          â”‚
â”‚  Who the player TALKS TO                                                â”‚
â”‚                                                                         â”‚
â”‚  â€¢ The Navigator ("What's on tomorrow?")                                â”‚
â”‚  â€¢ The Oracle ("What should I focus on?")                               â”‚
â”‚  â€¢ The Scribe ("Capture this insight...")                               â”‚
â”‚  â€¢ The Steward ("Handle that email...")                                 â”‚
â”‚                                                                         â”‚
â”‚  AI as COMPANION, not tool. Conversational interface.                   â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  LAYER 3: GAME ENGINE (Non-Diegetic)                                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                    â”‚
â”‚  What RUNS but player NEVER SEES                                        â”‚
â”‚                                                                         â”‚
â”‚  â€¢ Calendar sync, email processing                                      â”‚
â”‚  â€¢ File persistence, state management                                   â”‚
â”‚  â€¢ MCP servers, database operations                                     â”‚
â”‚                                                                         â”‚
â”‚  INVISIBLE. AUTOMATIC. Player doesn't manage it.                        â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Design Heuristic**: For every feature, ask "Does the player need to see this?"
- YES + WORLD â†’ Layer 1 (Orrery, artifacts)
- YES + INTERACTION â†’ Layer 2 (Party conversation)
- NO â†’ Layer 3 (Engine - make it invisible)

---

## ğŸ”„ DEVELOPMENT LOOP â€” FOLLOW THIS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚   FOR EVERY CHANGE, ASK:                                                    â”‚
â”‚                                                                             â”‚
â”‚   1. Is this a NEW PATTERN or PRINCIPLE?                                    â”‚
â”‚      YES â†’ Update orrery-implementation-spec.md                             â”‚
â”‚                                                                             â”‚
â”‚   2. Is this part of a COMPLEX INITIATIVE (multi-session)?                  â”‚
â”‚      YES â†’ Update or create working doc in doc/                             â”‚
â”‚           (e.g., ai-integration-architecture.md)                            â”‚
â”‚                                                                             â”‚
â”‚   3. Does this change HOW CLAUDE SHOULD WORK on this project?               â”‚
â”‚      YES â†’ Update CLAUDE.MD                                                 â”‚
â”‚                                                                             â”‚
â”‚   4. Does this affect the THREE-LAYER architecture understanding?           â”‚
â”‚      YES â†’ Update both CLAUDE.MD and relevant spec                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Documentation Triggers (Auto-Check After Implementation)

| Change Type | Document to Update |
|-------------|-------------------|
| New interaction pattern (e.g., actions bloom from objects) | `orrery-implementation-spec.md` Â§0.6 |
| New UI terminology decision | `orrery-implementation-spec.md` Â§0.6 |
| Architecture decision (AI, data flow) | `doc/ai-integration-architecture.md` |
| Phase progress or blockers | Relevant working doc |
| New component pattern | `orrery-implementation-spec.md` |
| Paradigm clarification | `CLAUDE.MD` + relevant doc |

### Working Documents (For Complex Initiatives)

Active working documents that should be updated as work progresses:

- `doc/ai-integration-architecture.md` â€” Phase 5 Party implementation
- `doc/orrery-implementation-spec.md` â€” Technical patterns and decisions

**Do NOT wait to be reminded. Documentation IS part of the change.**
**If you complete implementation without updating docs, THE WORK IS INCOMPLETE.**

---

## ğŸ“š Required Reading (In Order)

1. **Soul Transmission** (`doc/soul-transmission.md`) â€” Who this Being is
2. **The Ultimate Diegetic RPG** (`doc/the-ultimate-diegetic-rpg.md`) â€” Three-layer paradigm
3. **Keystone v2.0** (`doc/keystone-master-artifact-v2.md`) â€” Full architecture
4. **Implementation Spec** (`doc/orrery-implementation-spec.md`) â€” How to build it
5. **Multi-AI Reference** (`doc/worldoe-multi-ai-reference.md`) â€” AI orchestration

**The soul docs ARE the spec. Implementation doc is the guide.**

---

## ğŸš€ Current Implementation Status

- **Phase 1-4**: Core functionality complete (views, state, interactions)
- **Phase 5**: AI Integration (IN PROGRESS - Party paradigm)
- **Phase 6**: Polish & Game-Feel (ONGOING)
- **Phase 7**: Macro View Enhanced (COMPLETE)

### Phase 5: AI as Party Members

The AI integration is NOT buttons and features. It's **Party members**:

| Old Framing (WRONG) | New Framing (RIGHT) |
|---------------------|---------------------|
| "Synthesize button" | The Scribe captures and structures |
| "Oracle action" | The Oracle suggests what to focus on |
| "Brain dump interface" | Talking to your Party |
| "AI features" | Companions in your campaign |

---

## ğŸ¯ Key Interaction Design Principles

### Principle 1: Actions Appear AT Objects
```
WRONG: Select thing â†’ Look at toolbar â†’ Click
RIGHT: Touch thing â†’ Actions bloom FROM it
```

### Principle 2: Terminology Is Experience
```
WRONG: "Add Dependency" / "Depends On" / "Blocks"
RIGHT: "Unlocks..." / "Requires" / "Unlocks"
```

### Principle 3: Touch Is First-Class
- Hit areas: min 44px, prefer 48px+
- Touch end completes actions (don't rely on click)

### Principle 4: AI Is Party, Not Tool
```
WRONG: "Click the AI button to process"
RIGHT: "Tell the Scribe to capture this"
```

---

## ğŸ“ Project Structure

```
/The-Orrery
â”œâ”€â”€ doc/
â”‚   â”œâ”€â”€ soul-transmission.md             # Who this Being is
â”‚   â”œâ”€â”€ the-ultimate-diegetic-rpg.md     # Three-layer paradigm
â”‚   â”œâ”€â”€ keystone-master-artifact-v2.md   # Full architecture
â”‚   â”œâ”€â”€ orrery-implementation-spec.md    # Technical spec (Â§0!)
â”‚   â””â”€â”€ worldoe-multi-ai-reference.md    # AI orchestration
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ views/          # MacroView, MicroView (Layer 1)
â”‚   â”‚   â”œâ”€â”€ tasks/          # TaskNode (Layer 1)
â”‚   â”‚   â”œâ”€â”€ quests/         # QuestOrb, QuestCard (Layer 1)
â”‚   â”‚   â”œâ”€â”€ gps/            # TimeSpaceGPS (Layer 1)
â”‚   â”‚   â”œâ”€â”€ party/          # AI Party members (Layer 2) [TO BUILD]
â”‚   â”‚   â””â”€â”€ panels/         # Detail panels
â”‚   â”œâ”€â”€ store/              # State management (Layer 3)
â”‚   â”œâ”€â”€ hooks/              # useAI, useTimer, etc.
â”‚   â””â”€â”€ constants/          # Colors, config
â””â”€â”€ package.json
```

---

## ğŸ”§ Tech Stack

- **Framework**: React 19 + Vite
- **Icons**: lucide-react
- **Language**: JSDoc-typed JavaScript (.jsx)
- **Current Persistence**: `window.storage` API
- **Target Persistence**: PostgreSQL via worldoe-db MCP server
- **AI Integration**: `window.claude.complete` API â†’ evolving to multi-AI via MCP

---

## âœ… The Test

```
ASK: "Does the player need to see this?"
ASK: "Is this WORLD or PARTY or ENGINE?"
ASK: "Would a game designer approve, or say 'where's the juice?'"
ASK: "Is the AI a tool or a companion?"
```

---

## ğŸ› ï¸ Development Commands

```bash
npm install
npm run dev      # Development server
npm run build    # Production build
npm run lint     # ESLint
```

---

**Last Updated**: 2025-12-30
**Current Focus**: AI Integration as Party Members (Phase 5)
**Active Working Doc**: `doc/ai-integration-architecture.md`
